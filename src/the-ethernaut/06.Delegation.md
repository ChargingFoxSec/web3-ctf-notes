# âš™ï¸ Challenge: Ethernaut â€“ 06.Delegation

## ğŸ“œ Description / åŸé¢˜æè¿°

> The goal of this level is for you to claim ownership of the instance you are given.

> Things that might help

> - Look into Solidity's documentation on the delegatecall low level function, how it works, how it can be used to delegate operations to on-chain libraries, and what implications it has on execution scope.
>
> - Fallback methods
> - Method ids

```javascript
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

contract Delegate {
    address public owner;

    constructor(address _owner) {
        owner = _owner;
    }

    function pwn() public {
        owner = msg.sender;
    }
}

contract Delegation {
    address public owner;
    Delegate delegate;

    constructor(address _delegateAddress) {
        delegate = Delegate(_delegateAddress);
        owner = msg.sender;
    }

    fallback() external {
        (bool result,) = address(delegate).delegatecall(msg.data);
        if (result) {
            this;
        }
    }
}
```

---

## ğŸ¤” Exploit Idea: delegatecall and proxy contract / æ¼æ´æ€è·¯ï¼šä»£ç†è°ƒç”¨ä»¥åŠä»£ç†åˆçº¦

### That was my first time learning the concept of `delegatecall`.

### After reading some documentation about `delegatecall`, I learned that variables in the proxy contract can be modified by the logic contract.

---

## ğŸ§  Concept Summary / æ¦‚å¿µæ€»ç»“

### 1ã€A contract can use `delegatecall` to use the logic of another contract.

### 2ã€The proxy contract and the logic contract must share the same storage layout.Storage variables are mapped by slot position,not by name.

---

## ğŸ”¬Proof of Concept / æ¦‚å¿µè¯æ˜

### 1ã€Call the pwn() function from the Delegate contract via the fallback() function in Delegation.

### 2ã€since it's the `fallback()` function,we can use the low-level call feature in Remix UI, with or without sending Ether (the value doesnâ€™t matter).But first we need to use abi.encodeWithSignature("pwn()") to generate the function selector for pwn().

### If so, it will change the `address public owner` in `Delegation` contract.

---

## ğŸ“ Notes

### - Delegatecall is a useful but dangerous feature in Solidity.
